#æ¦‚è¦#
- class2apiå¸®åŠ©ä½ æŠŠJavascript Classç±»çš„é™æ€æ–¹æ³•è‡ªåŠ¨å‘å¤–æ˜ å°„ä¸ºAPIæ¥å£çš„å¾®å‹æ¡†æ¶ï¼Œå€ŸåŠ©class2apiï¼Œä½ å¯ä»¥åœ¨1åˆ†é’Ÿä¹‹å†…ç›´æ¥å¼€å§‹ç€æ‰‹äºä¸šåŠ¡é€»è¾‘ä»£ç çš„ç¼–å†™ï¼Œè€Œå°†è·¯ç”±ã€æ–¹æ³•ç¼“å­˜ã€ç½‘ç»œé€šè®¯ç­‰äº‹åŠ¡äº¤ç»™æˆ‘ä»¬å¤„ç†
- class2apiä»¥æš´éœ²çš„APIæ¥å£å¿…é¡»ä»¥postæ–¹å¼è¯·æ±‚ï¼Œä¸æ”¯æŒgetæ–¹å¼

#ä¸Šæ‰‹å‘å¯¼#

- å¿«é€Ÿå®‰è£…ä¾èµ–ç»„å»º
```
$ npm i 
æˆ–
$ npm i --registry=https://registry.npm.taobao.org 
```

- åŸºäºæºç ç‰ˆæœ¬è¿è¡ŒDemoåº”ç”¨(Serverç‰ˆæœ¬)
```
$ npm run start:src 
```

- åŸºäºæºç ç‰ˆæœ¬è¿è¡ŒDemoåº”ç”¨(ExpressRouterè·¯ç”±ç‰ˆæœ¬)
```
$ npm run start:srcrouter
```

- è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆå…ˆè¿è¡ŒDemoåº”ç”¨ï¼‰
```
$ mocha test/test.run
```

- åŸºç¡€Curlæµ‹è¯•è°ƒç”¨ï¼ˆå…ˆè¿è¡ŒDemoåº”ç”¨ï¼‰
```
$ mocha test/test.run
```

#å¿«é€Ÿåˆ›å»ºåº”ç”¨çš„ä»£ç #
- èŠ‚é€‰ä»£ç ï¼Œæ¥è‡ª example/baseProject èŒƒä¾‹é¡¹ç›®
```javascript
    import {createServer} from 'class2api'
    import {GKErrors} from 'class2api/gkerrors'

    //åˆ›å»ºå¾®æœåŠ¡å¯¹è±¡
    createServer({
        config: {
            apiroot: '/',
            cros: true,
        }, 
        //å°†å“ªäº›ç±»æ˜ å°„åˆ°APIï¼Œé»˜è®¤å–ç±»åç§°çš„å°å†™å­—ç¬¦ï¼Œä¹Ÿå¯ä»¥å®šä¹‰è·¯å¾„çš„åˆ«å
        modelClasses: [ClassA, {model: ClassB, as: 'b'}], 
        beforeCall:({req, params, modelSetting})=>{ 
            //Apiå¤„ç†ä¹‹å‰ï¼Œåœ¨è¿™é‡Œè¿›è¡Œæƒé™èº«ä»½éªŒè¯ã€è¯·æ±‚å‚æ•°é¢„å¤„ç†ç­‰æ“ä½œ
            // ....
            //è¿”å›çš„paramsä¼šä¼ é€’ç»™APIå¯¹åº”çš„å®é™…é™æ€æ–¹æ³•
            return params 
        },
        afterCall:({req,res,result})=>{
            //Apiå¤„ç†ç»“æŸï¼Œåœ¨è¿”å›resultç»™å®¢æˆ·ç«¯ä¹‹å‰ï¼Œå¯ä»¥åšé™„åŠ å¤„ç†ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—æˆ–è¾“å‡ºé¢å¤–çš„é™„åŠ ä¿¡æ¯ç»™è°ƒç”¨æ–¹
            // ....
            return result
        }
        
    }).then((server)=>{
    
        //å¼€å§‹ç›‘å¬æŒ‡å®šçš„ç«¯å£
    server.listen(port, "0.0.0.0", function onStart(err){
            if (err) {
                console.log(err);
            }
            console.info("==> ğŸŒ Listening on port %s. Open up http://0.0.0.0:%s/ in your browser.", port, port);
        });
    
    }).catch((error)=>{
        setTimeout(function(){throw error})
    })
```

# å¯¼å‡ºåŠŸèƒ½å‡½æ•°ï¼š

class2api/
- createServer, åˆ›å»ºæœåŠ¡å™¨(ä½¿ç”¨å†…å»ºçš„ç‹¬ç«‹Expresså®ä¾‹)
- createServerInRouter, åˆ›å»ºæœåŠ¡å™¨(ä½¿ç”¨å¤–éƒ¨çš„Expressï¼Œåªè¿”å›routerä¾›ç»‘å®šè·¯ç”±)
- getGankaoWXAuthToken,*ä»redisä¸­è¯»å–èµ¶è€ƒtokençš„ç®€å•å°è£…ï¼Œæ–¹ä¾¿ä½¿ç”¨æ–¹ä¸ç”¨é‡æ–°åˆ›å»ºrediså®ä¾‹ã€‚å°†æ¥å¯ä»¥å‰¥ç¦»
- setting_redisConfigï¼Œè®¾ç½®å†…ç½®redisçš„è¿æ¥å‚æ•°
- getRedisClient,è·å¾—redisè®¿é—®å®ä¾‹
- GKErrorWrap   é”™è¯¯åŒ…è£…å™¨ï¼Œå½“é¢„è®¾é”™è¯¯ç±»å‹ä¸å¤Ÿç”¨æ—¶ï¼Œå¯è‡ªå®šä¹‰
- modelSetting  ä¿®é¥°å™¨ï¼Œç±»æ¨¡å—çš„å…ƒä¿¡æ¯é…ç½®ç±»
- cacheAble     ä¿®é¥°å™¨,å¯ç”¨ç±»æ–¹æ³•è°ƒç”¨ç¼“å­˜çš„ä¿®é¥°å™¨
- clearCache    ä¿®é¥°å™¨,æ¸…ç©ºç±»æ–¹æ³•è°ƒç”¨ç¼“å­˜çš„ä¿®æ—¶å™¨
- accessRule    ä¿®é¥°å™¨,æä¾›è®¿é—®æƒé™çš„æ ¡éªŒæ§åˆ¶,å¯ç‹¬ç«‹é…ç½®è®¤è¯å‡½æ•°
- setting_RuleValidator  accessRuleè®¿é—®æƒé™ä¿®é¥°å™¨ä¸­è®¤è¯å‡½æ•°çš„å…¨å±€é…ç½®å…¥å£
- crashAfterMe  ä¿®é¥°å™¨,è¿è¡Œå®Œç±»æ–¹æ³•å°±è®¤ä¸ºè·‘å‡ºå¼‚å¸¸ä¸­æ–­ç¨‹åºï¼Œè°ƒè¯•ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹è‡ªåŠ¨å¤±æ•ˆ

class2api/dbhelper
- GKErrors  å¸¸ç”¨é¢„è®¾çš„é”™è¯¯  
- TableSetting  sequelizeModelå®šä¹‰modelæ—¶çš„æ‰©å±•é…ç½®
- ResetDB   é‡ç½®æ•°æ®åº“
- DBModelLoader åŠ è½½Modelå®šä¹‰æ–‡ä»¶
- DBUtils   æ•°æ®åº“çš„è¾…åŠ©å·¥å…·æ–¹æ³•
- fn        sequezeliçš„èšåˆå‡½æ•°å¼•ç”¨
- col       sequezeliçš„åˆ—å¼•ç”¨å‡½æ•°
- literal   sqlè¯­å¥å­—é¢é‡åŒ…è£…å‡½æ•°ï¼Œç¡®ä¿sequelizeä¸è§£ææ­¤SQLå­—ç¬¦ä¸²
- where     sequezeliçš„whereå¼•ç”¨å‡½æ•°
- createTransaction åˆ›å»ºä¸€ä¸ªsequezeliäº‹åŠ¡
- excuteSQL æ‰§è¡ŒæŒ‡å®šçš„SQLè¯­å¥ï¼Œä¸€èˆ¬é€‚ç”¨äºæ— æ³•ç”¨sequelizeè¡¨è¾¾å¼çš„å¤æ‚æŸ¥è¯¢

class2api/testhelper
- setApiRoot,å¸¸ç”¨é¢„è®¾çš„é”™è¯¯  
- ApiDesc
- WebInvokeHepler(usertoken)(apiPath, postParams, apiDesc)
- save2Doc


$ npm publish --registry=http://registry.npmjs.org



